<div #containerRef>
    <h3>Blood Pressure</h3>
 <!--   <ngx-charts-box-chart
            [view]="[panelRef.offsetWidth, 200]"
            [scheme]="colorSeries"
            [showXAxisLabel]="showXAxisLabel"
            [showYAxisLabel]="showYAxisLabel"
            [xAxis]="true"
            [yAxis]="true"
            [legend]="false"
            xAxisLabel="Date"
            yAxisLabel="Body Weight"
            [results]="bpSeries"
    >
    </ngx-charts-box-chart> -->
    <mat-accordion>
        <mat-expansion-panel>
            <mat-expansion-panel-header>
                <mat-panel-title>
                    Blood Pressure - {{round(getLast(bpSeries))}}/{{round(getLastSingle(bpSeries[1]))}} mmHg
                </mat-panel-title>
                <mat-panel-description>
                     <span *ngIf="(getLast(bpSeries) > 135 || getLastSingle(bpSeries[1]) > 85)">
                            <button mat-flat-button color="accent">High</button>
                         </span>
                     <span *ngIf="(getLast(bpSeries) < 89 || getLastSingle(bpSeries[1]) < 59)">
                            <button mat-flat-button color="accent">Low</button>
                     </span>
                     <span *ngIf="bpReferenceLines.length > 1">
                         <span *ngIf="(getLastSingle(bpSeries[1])- bpReferenceLines[1].value > 5) || (getLast(bpSeries) - bpReferenceLines[0].value > 5)">
                            <button mat-flat-button color="accent">Overtraining?</button>
                         </span>
                         Average Blood Pressure {{bpReferenceLines[0].value}}/{{bpReferenceLines[1].value}}
                     </span>
                </mat-panel-description>
            </mat-expansion-panel-header>
                <ngx-charts-line-chart
                        [view]="[containerRef.offsetWidth, 250]"
                        [scheme]="colorSeries"

                        [showXAxisLabel]="false"
                        [showYAxisLabel]="true"
                        [xAxis]="true"
                        [curve]="curve"
                        [yAxis]="true"
                        [legend]="true"
                        [yScaleMin]="scaleMin"
                        [yScaleMax]="scaleMax"
                        [legendPosition]="legendPosition"
                        xAxisLabel="Date"
                        yAxisLabel="mmHg"
                        [referenceLines]="bpReferenceLines"
                        [showRefLines]="true"
                        [timeline]="timeline"
                        [results]="bpSeries"
                >
                </ngx-charts-line-chart>
                <!-- These breaks allow for legend display TODO -->
                <br/>
                <br/>
                <br/>
        </mat-expansion-panel>
    </mat-accordion>
    <h3>Weight</h3>
    <mat-accordion>
        <mat-expansion-panel>
        <mat-expansion-panel-header>
            <mat-panel-title >
                Weight - {{round1DP(getLast(weights))}} Kg
            </mat-panel-title>
            <mat-panel-description>
                <span *ngIf="weightReferenceLines.length > 0">
                         <span *ngIf="(getLast(weights) - weightReferenceLines[0].value) > epr.weightWarnHigh">
                            <button mat-flat-button [ngStyle]="{'background':'lightgreen'}">Full</button>
                         </span>
                          <span *ngIf="(getLast(weights) - weightReferenceLines[0].value) < epr.weightWarnLow">
                            <button mat-flat-button color="accent">Refuel & Drink</button>
                         </span>
                         Average Weight {{round1DP(weightReferenceLines[0].value)}} Kg
                </span>
            </mat-panel-description>
        </mat-expansion-panel-header>
            <div #panelRef>
            <ngx-charts-line-chart
                    [view]="[panelRef.offsetWidth, 200]"
                    [scheme]="colorSeries"
                    [showXAxisLabel]="showXAxisLabel"
                    [showYAxisLabel]="showYAxisLabel"
                    [xAxis]="true"
                    [yAxis]="true"
                    [curve]="curve"
                    [yScaleMin]="weightMin"
                    [yScaleMax]="weightMax"
                    [legend]="false"
                    xAxisLabel="Date"
                    yAxisLabel="Body Weight"
                    [timeline]="timeline"
                    [results]="weights"
                    [referenceLines]="weightReferenceLines"
                    [showRefLines]="true"
            >
            </ngx-charts-line-chart>
            </div>
        </mat-expansion-panel>
        <mat-expansion-panel>
            <mat-expansion-panel-header>
                <mat-panel-title>
                    Fat Mass - {{round1DP(getLast(fats))}} Kg ({{round1DP(getLast(fats) * 100 / getLast(weights))}} %)
                </mat-panel-title>
                <mat-panel-description>
                      <span *ngIf="fatsReferenceLines.length > 0">
                         Average Fat Mass {{round1DP(fatsReferenceLines[0].value)}} Kg
                </span>
                </mat-panel-description>
            </mat-expansion-panel-header>
            <div #panelRef>
            <ngx-charts-line-chart
                    [view]="[panelRef.offsetWidth, 200]"
                    [scheme]="colorSeries"
                    [curve]="curve"
                    [showXAxisLabel]="showXAxisLabel"
                    [showYAxisLabel]="showYAxisLabel"
                    [xAxis]="true"
                    [yAxis]="true"
                    [yScaleMin]="fatMin"
                    [yScaleMax]="fatMax"
                    [legend]="false"
                    xAxisLabel="Date"
                    yAxisLabel="Fat Mass"
                    [timeline]="timeline"
                    [results]="fats"
                    [referenceLines]="fatsReferenceLines"
                    [showRefLines]="true"
            >
            </ngx-charts-line-chart>
            </div>
        </mat-expansion-panel>
        <mat-expansion-panel>
            <mat-expansion-panel-header>
                <mat-panel-title>
                    Muscle Mass - {{round1DP(getLast(muscle))}} Kg ({{round1DP(getLast(muscle) * 100 / getLast(weights))}} %)
                </mat-panel-title>
                <mat-panel-description>
                      <span *ngIf="muscleReferenceLines.length > 0">
                           <span *ngIf="(getLast(muscle) - muscleReferenceLines[0].value) < epr.muscleWarnLow">
                            <button mat-flat-button color="accent">Check Carbs Intake</button>
                         </span>
                         Average Muscle Mass {{round1DP(muscleReferenceLines[0].value)}} Kg
                    </span>
                </mat-panel-description>
            </mat-expansion-panel-header>
            <div #panelRef>
            <ngx-charts-line-chart
                    [view]="[panelRef.offsetWidth, 200]"
                    [scheme]="colorSeries"
                    [showXAxisLabel]="showXAxisLabel"
                    [showYAxisLabel]="showYAxisLabel"
                    [curve]="curve"
                    [xAxis]="true"
                    [yAxis]="true"
                    [yScaleMin]="muscleMin"
                    [yScaleMax]="muscleMax"
                    [legend]="false"
                    xAxisLabel="Date"
                    yAxisLabel="Muscle Mass"
                    [timeline]="timeline"
                    [results]="muscle"
                    [referenceLines]="muscleReferenceLines"
                    [showRefLines]="true"
            >
            </ngx-charts-line-chart>
            </div>
        </mat-expansion-panel>
        <mat-expansion-panel>
            <mat-expansion-panel-header>
                <mat-panel-title>
                    Body Water - {{round1DP(getLast(hydration))}} Kg ({{round1DP(getLast(hydration) * 100 / getLast(weights))}} %)
                </mat-panel-title>
                <mat-panel-description>
                      <span *ngIf="hydrationReferenceLines.length > 0">
                           <span *ngIf="(getLast(hydration) - hydrationReferenceLines[0].value) > epr.hydratedWarnHigh">
                            <button mat-flat-button [ngStyle]="{'background':'lightgreen'}">Hydrated</button>
                         </span>
                          <span *ngIf="(getLast(hydration) - hydrationReferenceLines[0].value) < epr.hydratedWarnLow">
                            <button mat-flat-button color="accent">Dehydrated</button>
                         </span>
                         Average Body Water {{round1DP(hydrationReferenceLines[0].value)}} Kg
                </span>
                </mat-panel-description>
            </mat-expansion-panel-header>
            <div #panelRef>
            <ngx-charts-line-chart
                    [view]="[panelRef.offsetWidth, 200]"
                    [scheme]="colorSeries"

                    [showXAxisLabel]="showXAxisLabel"
                    [showYAxisLabel]="showYAxisLabel"
                    [xAxis]="true"
                    [yAxis]="true"
                    [curve]="curve"
                    [yScaleMin]="hydrationMin"
                    [yScaleMax]="hydrationMax"
                    [legend]="false"
                    xAxisLabel="Date"
                    yAxisLabel="Body Water"
                    [timeline]="timeline"
                    [results]="hydration"
                    [referenceLines]="hydrationReferenceLines"
                    [showRefLines]="true"
            >
            </ngx-charts-line-chart>
            </div>
        </mat-expansion-panel>
    </mat-accordion>
</div>
